# Math Insight Map

**高校数学の理解地図** — 単元ごとの「どの概念がどこまで理解されているか」をグラフで可視化する、個人講師・塾講師向けの指導支援ツールです。

ノード（学習項目）ごとに理解度（0〜4）とメモを記録でき、前提関係（prerequisites）に沿ってグラフを表示します。どこが弱いか・何から指導すべきかが一目で分かります。データは端末内（localStorage）にのみ保存されるため、教室や自宅の PC で安全に利用できます。

---

## 目次

- [技術スタック](#技術スタック)
- [開発](#開発)
- [使い方（5分で使える）](#使い方5分で使える)
- [配布について](#配布について)
- [参考にした資料](#参考にした資料)
- [主な機能](#主な機能)
- [理解度スケール](#理解度スケール)
- [プライバシー](#プライバシー)
- [免責事項](#免責事項)

---

## 技術スタック

- **React** + **TypeScript** + **Vite**
- **React Flow**（グラフ描画）
- **localStorage**（データ永続化）

---

## 開発

```bash
npm install
npm run dev
```

表示された URL（例: http://localhost:5173）をブラウザで開く。

**ビルド:** `npm run build` → 成果物は `dist/` に出力される。

---

## 使い方（5分で使える）

1. **起動**  
   `npm run dev` で起動し、表示された URL をブラウザで開く。

2. **生徒を選ぶ**  
   生徒一覧で既存の生徒名をクリック。いなければ「新規生徒を追加」から名前を入力して追加する。

3. **理解地図を見る**  
   グラフの各ノードが学習項目、矢印が「前提関係」（学ぶとよい順）を表す。  
   ノードの色は理解度の目安：**赤**＝未学習〜見たことがある、**黄**＝誘導ありでできる、**緑**＝一人で解ける〜説明できる。

4. **理解度・メモを記録する**  
   ノードをクリックすると右側にパネルが開く。「理解度」を 0〜4 から選び、必要なら「メモ」を入力。変更は自動で端末内に保存される。

5. **指導のヒントを使う**  
   パネル下部の「指導提案」に、前提のうち理解度が低い項目が表示される。ボトルネック（複数の先が依存している弱い箇所）は画面上部にも表示。単元はヘッダのドロップダウンで切り替え可能。

6. **単元間の理解度マップ**  
   単元マップ画面で生徒を選択し「単元間の理解度マップ」を開くと、単元どうしの前提関係と理解度の概要を確認できる。

**配布用に初期化する場合**  
生徒一覧ページのヘッダー右側「理解度を初期化（配布用）」を実行すると、全生徒の理解度リセット・デモ生徒以外の削除・カスタム単元の削除が行われ、配布用のクリーンな状態になる。

---

## 配布について

### 配布のパターン

| パターン | 渡すもの | 受け取った側の前提 |
|----------|----------|----------------------|
| **A. ソース配布** | リポジトリ一式（ZIP または `git clone`） | **Node.js**（v18 以上、推奨 v20）と **npm** がインストールされていること |
| **B. ビルドのみ配布** | `npm run build` した **`dist/` 一式**を ZIP で渡す | **ブラウザ**のみ（Node 不要） |

### ビルド済み（`dist/`）の開き方

- **Node がある場合（推奨）:** `npx serve dist` を実行し、表示された URL をブラウザで開く。
- **Node を入れたくない場合:** `dist/index.html` をブラウザにドラッグして開く方法もあるが、ルーティングによっては不具合が出ることがあるため、`npx serve dist` を推奨。

### 動作環境

- **OS:** Windows / Mac / Linux いずれも利用可能。
- **ブラウザ:** Chrome / Firefox / Safari / Edge など現代のブラウザ。

---

## 参考にした資料

組み込み単元（単元名・項目の順序・前提関係）の設計にあたり、以下の公式資料を参照しています。

- **[高等学校学習指導要領（平成30年告示）解説 数学編・理数編](https://www.mext.go.jp/content/20260115-mxt_kyoiku02-100002620_04.pdf)**（文部科学省）  
  単元構成や指導事項の整理は、上記 PDF の内容を参考にしています。

プロジェクト内の詳細な参照メモ（科目構成・指導事項の抜粋など）は `src/data/curriculum_reference.md` にまとめてあります。

---

## 主な機能

- **理解地図**  
  単元ごとの有向グラフ表示（prerequisites → エッジ）。ノード色は理解度で変化（赤→黄→緑）。
- **生徒管理**  
  生徒一覧・新規追加。1 生徒ごとに単元別の理解度・メモを localStorage に保存。
- **単元**  
  組み込み単元（二次関数・平方根・三角比・数と式・データの分析 など）＋ カスタムテンプレートの追加・編集・エクスポート・削除。
- **ノード詳細**  
  ノードクリックで右パネルに理解度（0〜4）・メモ・最終確認日を表示・編集。変更は即時反映・自動保存。
- **指導支援**  
  ボトルネック表示、選択ノードの「指導提案」（前提のうち理解度が低い順）。
- **単元間理解度マップ**  
  単元どうしの前提関係と、単元ごとの理解度サマリを表示。
- **配布用初期化**  
  全生徒の理解度リセット・デモ生徒以外の削除・カスタム単元の削除を一括実行。

---

## 理解度スケール

| 値 | 意味             |
|----|------------------|
| 0  | 未学習           |
| 1  | 見たことがある   |
| 2  | 誘導ありでできる |
| 3  | 一人で解ける     |
| 4  | 説明できる       |

---

## 動作確認チェックリスト

- [x] 組み込み単元のノードがすべて表示され、依存関係が矢印で分かる
- [x] 理解度を変更するとノード色が即座に変わる
- [x] ページを更新しても生徒・理解度・メモが保持される
- [x] 複数生徒の追加・切り替えができる
- [x] 単元の切り替えで別単元の理解地図が表示される
- [x] ボトルネック・指導提案が表示される
- [x] 単元テンプレートのコピー・編集・エクスポート・削除ができる
- [x] 配布用初期化で理解度・他生徒・カスタム単元がクリアされる

---

## 今後の拡張候補

- クラウド保存・共有、認証（複数講師対応）
- データのバックアップ／インポート（JSON 一括）
- テンプレートのインポート・他単元の組み込み追加

---

## プライバシー

本アプリは、学習指導を支援する目的で、生徒の理解状況に関する情報を取り扱います。

- **取得・保存する情報:** 生徒の表示名または ID、単元ごとの理解度（0〜4）、任意のメモ。本名や連絡先の入力は想定していません。
- **保存場所:** 利用者の端末内（localStorage 等）にのみ保存。**外部サーバーへ送信しません。**
- **第三者提供:** 開発者または第三者がデータを取得・閲覧・利用することはありません。
- **推奨:** 講師自身の管理下で使用すること。メモ欄に学習指導に不要な個人情報（健康・家庭事情等）は記載しないことを推奨。

---

## 免責事項

本アプリは「ローカル利用」を前提としたツールです。クラウド保存や共有機能を追加する場合は、別途プライバシーポリシーの整備が必要となります。

**再配布について:** 再配布は禁止しません。ただし、再配布された複製の内容・改変・利用によって生じた問題について、原作者は責任を負いません。再配布は自己の責任で行ってください。

---

**Privacy (EN):** This application does not collect or transmit any personal data externally. All data is stored locally on the user's device.
